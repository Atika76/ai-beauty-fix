<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>üî• AI Beauty Fix ‚Äî Fot√≥retus√°l√°s</title>
  <meta name="description" content="Gyors AI fot√≥-retus√°l√°s ‚Äî ingyenes 3 k√©p/nap v√≠zjellel, kreditcsomagok √©s el≈ëfizet√©sek.">
  <style>
    :root{
      --accent:#7c3aed;
      --bg1:#071022;
      --bg2:#08142a;
      --card:rgba(255,255,255,0.04);
      --muted:#9fb0c7;
      --glass:rgba(255,255,255,0.03);
      --radius:14px;
      font-synthesis: none;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#eaf4ff;min-height:100vh}
    .wrap{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;gap:16px}
    .logo{display:flex;align-items:center;gap:12px}
    .logo img{width:64px;height:64px;object-fit:contain;border-radius:10px;background:linear-gradient(90deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));padding:8px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    nav{margin-left:auto}
    nav a{color:var(--muted);text-decoration:none;margin-left:14px;font-weight:600}
    .hero{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:20px}
    .card{background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    .muted{color:var(--muted);font-size:13px}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:var(--accent);color:white;text-decoration:none;font-weight:700;cursor:pointer;border:none}
    .mutebtn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px;border-radius:10px}
    label{display:block;margin-top:12px;font-weight:700}
    input[type=file]{display:block;margin-top:8px}
    #preview,#resultImg{max-width:100%;border-radius:10px;display:block;margin-top:12px}
    select,input,button{font-family:inherit}
    .watermark{position:absolute;left:12px;bottom:12px;padding:6px 10px;background:rgba(0,0,0,0.35);border-radius:8px;font-weight:700;color:rgba(255,255,255,0.9)}
    footer{margin-top:20px;color:var(--muted);font-size:13px;text-align:center}
    /* responsive */
    @media (max-width:900px){
      .hero{grid-template-columns:1fr}
      nav{display:none}
      .logo img{width:56px;height:56px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">
        <img src="logo.png" alt="AI Beauty Fix logo" id="siteLogo" onerror="this.style.display='none'">
        <div>
          <h1>üî• AI Beauty Fix</h1>
          <p class="lead">Gyors AI fot√≥-retus√°l√°s ‚Äî pr√≥b√°ld ki ingyen, 3 k√©p/nap (v√≠zjellel).</p>
        </div>
      </div>
      <nav>
        <a href="#upload" onclick="showView('upload')">Felt√∂lt√©s</a>
        <a href="#pricing" onclick="showView('pricing')">√Årak</a>
        <a href="#admin" onclick="showView('admin')">Admin</a>
      </nav>
    </header>

    <main class="hero">
      <section class="card">
        <h2>Gyors kezd√©s</h2>
        <p class="muted">T√∂lts fel egy k√©pet, v√°lassz opci√≥t: ingyenes (v√≠zjel) vagy kredit / el≈ëfizet√©s. 1 retus = 1 kredit.</p>

        <div style="margin-top:12px">
          <strong>Kreditek: </strong><span id="creditDisplay">0</span>
        </div>

        <hr style="margin:14px 0;border:none;border-top:1px solid rgba(255,255,255,0.04)">

        <div id="upload" class="section">
          <label for="fileInput">V√°lassz fot√≥t (JPG/PNG, max 20MB)</label>
          <input id="fileInput" type="file" accept="image/*">
          <canvas id="canvas" style="display:none"></canvas>
          <img id="preview" src="#" alt="preview" style="display:none">
          <label>Opci√≥</label>
          <select id="optionSelect">
            <option value="free">Ingyenes retus (v√≠zjel) ‚Äî limit 3/nap</option>
            <option value="credit">Haszn√°lj kreditet (v√≠zjel n√©lk√ºli)</option>
            <option value="paynow">V√°s√°rl√°s / egyedi fizet√©s</option>
          </select>
          <div style="margin-top:12px">
            <button class="btn" id="processBtn">Retus√°l√°s ind√≠t√°sa</button>
            <button class="mutebtn" onclick="showView('pricing')" style="margin-left:8px">Kreditek / el≈ëfizet√©s</button>
            <span id="status" class="muted" style="margin-left:12px"></span>
          </div>

          <div id="resultWrap" style="margin-top:16px;display:none;position:relative">
            <h3>Eredm√©ny</h3>
            <img id="resultImg" src="#" alt="result">
            <div id="wmTag" class="watermark" style="display:none">AI Beauty Fix ‚Äî DEMO (V√çZJEL)</div>
            <div style="margin-top:10px">
              <a id="downloadBtn" class="btn" download>Let√∂lt√©s</a>
            </div>
          </div>
        </div>
      </section>

      <aside class="card">
        <h3>√Årak & Csomagok</h3>
        <p class="muted">1 retus = 1 kredit. V√°laszd a neked megfelel≈ët ‚Äî a PayPal gombok a fizet√©shez visznek.</p>

        <div style="margin-top:12px" id="pricing">
          <!-- PayPal forms (return URLs are set by JS) -->
          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
            <input type="hidden" name="cmd" value="_xclick">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="10 retus kredit">
            <input type="hidden" name="amount" value="1490">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="hidden" name="cancel_return" value="">
            <input type="submit" class="btn" value="10 retus ‚Äî 1490 Ft">
          </form>

          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
            <input type="hidden" name="cmd" value="_xclick">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="20 retus kredit">
            <input type="hidden" name="amount" value="2490">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="hidden" name="cancel_return" value="">
            <input type="submit" class="btn" value="20 retus ‚Äî 2490 Ft">
          </form>

          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
            <input type="hidden" name="cmd" value="_xclick">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="50 retus kredit">
            <input type="hidden" name="amount" value="4990">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="hidden" name="cancel_return" value="">
            <input type="submit" class="btn" value="50 retus ‚Äî 4990 Ft">
          </form>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.04)">

          <h4>Havi el≈ëfizet√©sek</h4>
          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
            <input type="hidden" name="cmd" value="_xclick-subscriptions">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="AI Beauty Fix - Alap (50 retus/h√≥)">
            <input type="hidden" name="a3" value="2490">
            <input type="hidden" name="p3" value="1">
            <input type="hidden" name="t3" value="M">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="submit" class="btn" value="Alap ‚Äî 2490 Ft / h√≥">
          </form>

          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post">
            <input type="hidden" name="cmd" value="_xclick-subscriptions">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="AI Beauty Fix - Premium (150 retus/h√≥)">
            <input type="hidden" name="a3" value="4990">
            <input type="hidden" name="p3" value="1">
            <input type="hidden" name="t3" value="M">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="submit" class="btn" value="Pr√©mium ‚Äî 4990 Ft / h√≥">
          </form>

        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.04)">
        <p class="muted">Admin demo bel√©p√©s a fels≈ë men√ºb≈ël. √âles haszn√°lathoz sz√ºks√©ges: PayPal webhooks/IPN √©s szerver-oldali hiteles√≠t√©s.</p>
      </aside>
    </main>

    <div id="admin" class="card" style="margin-top:18px;display:none">
      <h3>Admin</h3>
      <p class="muted">Demo admin funkci√≥k a kliens oldalon ‚Äî √©les√≠tett szerver-oldali auth kell</p>
    </div>

    <footer>
      <p class="muted">¬© AI Beauty Fix ‚Ä¢ PayPal: atika.76@windowslive.com</p>
    </footer>
  </div>

  <script>
    // router
    function showView(id){
      document.querySelectorAll('.section').forEach(s=>s.style.display='none');
      if(id==='upload') document.querySelector('#upload').style.display='block';
      if(id==='pricing') document.querySelector('#pricing').style.display='block';
      if(id==='admin'){document.getElementById('admin').style.display='block'}
      window.location.hash='#'+id;
    }
    // init
    showView('upload');

    // credits (localStorage)
    function getCredits(){return Number(localStorage.getItem('aib_credits')||0)}
    function setCredits(n){localStorage.setItem('aib_credits',String(n));document.getElementById('creditDisplay').innerText=n}
    setCredits(getCredits());

    // free usage tracking (3/day)
    function freeCountToday(){const k='aib_free_'+(new Date()).toISOString().slice(0,10);return Number(localStorage.getItem(k)||0)}
    function incFreeCount(){const k='aib_free_'+(new Date()).toISOString().slice(0,10);localStorage.setItem(k,String(freeCountToday()+1))}

    // file handling & preview
    const fileInput=document.getElementById('fileInput');
    const preview=document.getElementById('preview');
    const canvas=document.getElementById('canvas');
    const ctx=canvas.getContext('2d');
    let currentImage=null;
    fileInput.addEventListener('change',e=>{
      const f=e.target.files[0];
      if(!f) return;
      if(f.size>20*1024*1024){alert('A f√°jl t√∫l nagy (max 20MB)');return}
      const url=URL.createObjectURL(f);
      preview.src=url; preview.style.display='block'; currentImage=f;
    });

    document.getElementById('processBtn').addEventListener('click',()=>{
      if(!currentImage){alert('V√°lassz egy k√©pet!');return}
      const opt=document.getElementById('optionSelect').value;
      if(opt==='free'){
        if(freeCountToday()>=3){alert('El√©rted a napi ingyenes limitet (3). V√°s√°rolj kreditet vagy el≈ëfizet√©st.'); return }
        incFreeCount(); simulateRetouch(true);
      } else if(opt==='credit'){
        if(getCredits()<=0){ if(confirm('Nincsen el√©g kredited. V√°s√°rolsz most?')) showView('pricing'); return }
        setCredits(getCredits()-1); simulateRetouch(false);
      } else {
        showView('pricing'); alert('V√°lassz egy kreditcsomagot a fizet√©shez.');
      }
    });

    function simulateRetouch(watermarked){
      const img=new Image();
      img.onload=()=>{
        canvas.width=img.width; canvas.height=img.height; ctx.clearRect(0,0,canvas.width,canvas.height);
        // basic enhancement simulation
        ctx.drawImage(img,0,0);
        try{ ctx.filter='contrast(1.06) saturate(1.05)'; ctx.drawImage(canvas,0,0); }catch(e){}
        // soft blur via scale trick
        const tmp=document.createElement('canvas');
        tmp.width=Math.max(1,Math.floor(img.width*0.5)); tmp.height=Math.max(1,Math.floor(img.height*0.5));
        const tctx=tmp.getContext('2d'); tctx.drawImage(canvas,0,0,tmp.width,tmp.height); ctx.drawImage(tmp,0,0,img.width,img.height);
        // warming overlay
        ctx.globalCompositeOperation='soft-light'; ctx.fillStyle='rgba(255,240,220,0.02)'; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.globalCompositeOperation='source-over';
        const dataUrl=canvas.toDataURL('image/jpeg',0.92);
        document.getElementById('resultImg').src=dataUrl;
        document.getElementById('resultWrap').style.display='block';
        document.getElementById('downloadBtn').href=dataUrl;
        if(watermarked){ document.getElementById('wmTag').style.display='block'; applyWatermarkToCanvas(); } else { document.getElementById('wmTag').style.display='none'; }
      };
      img.src=URL.createObjectURL(currentImage);
    }

    function applyWatermarkToCanvas(){
      ctx.font='36px system-ui'; ctx.fillStyle='rgba(255,255,255,0.12)'; ctx.textAlign='left';
      const txt='AI Beauty Fix';
      ctx.fillText(txt,20,canvas.height-40);
      const data=canvas.toDataURL('image/jpeg',0.92);
      document.getElementById('resultImg').src=data;
      document.getElementById('downloadBtn').href=data;
    }

    // PayPal return handling (demo): adds credits after redirect
    (function handleReturn(){
      const qp=new URLSearchParams(location.search);
      if(qp.get('paid')==='1'){
        const pack=qp.get('pack'); let add=0; if(pack==='10') add=10; if(pack==='20') add=20; if(pack==='50') add=50; if(pack==='100') add=100;
        if(add>0){ setCredits(getCredits()+add); alert('K√∂sz√∂nj√ºk! A kifizet√©s feldolgozva (demo). '+add+' kreditet j√≥v√°√≠rtunk.'); }
      }
      if(qp.get('sub')){ const s=qp.get('sub'); if(s==='basic'){ setCredits(50); alert('El≈ëfizet√©s aktiv√°lva (demo): 50 kredit/h√≥'); } if(s==='premium'){ setCredits(150); alert('El≈ëfizet√©s aktiv√°lva (demo): 150 kredit/h√≥'); } if(s==='pro'){ setCredits(9999); alert('Pro el≈ëfizet√©s: korl√°tlan (demo)'); } }
    })();

    // auto-set PayPal return URLs so forms work on GitHub Pages without manual edit
    document.addEventListener('DOMContentLoaded', function(){
      const origin = window.location.origin;
      const path = window.location.pathname.replace(/\/index\.html$/, '/');
      const base = origin + path;
      const forms=document.querySelectorAll('form[action*="paypal.com"]');
      forms.forEach(form=>{
        const item=form.querySelector('input[name=item_name]');
        let pack=''; if(item){
          const name=item.value.toLowerCase();
          if(name.includes('10')) pack='?paid=1&pack=10';
          if(name.includes('20')) pack='?paid=1&pack=20';
          if(name.includes('50')) pack='?paid=1&pack=50';
          if(name.includes('100')) pack='?paid=1&pack=100';
          if(name.includes('alap')) pack='?sub=basic';
          if(name.includes('premium')) pack='?sub=premium';
          if(name.includes('pro')) pack='?sub=pro';
        }
        const ret=form.querySelector('input[name=return]');
        const cancel=form.querySelector('input[name=cancel_return]');
        if(ret) ret.value = base + (pack||'');
        if(cancel) cancel.value = base + '?cancel=1';
      });
    });
  </script>
</body>
</html>
