<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>AI Beauty Fix ‚Äî Fot√≥retus√°l√°s</title>
  <meta name="description" content="Gyors AI fot√≥-retus√°l√°s ‚Äî Ingyenes 3 k√©p/nap v√≠zjellel. Kreditcsomagok √©s havi el≈ëfizet√©sek PayPal-lal.">

  <!-- Favicons & PWA (t√∂ltsd fel a megfelel≈ë log√≥ f√°jlokat a repo gy√∂ker√©be) -->
  <link rel="icon" type="image/png" sizes="16x16" href="/logo-16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/logo-32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/logo-180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/logo-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/logo-512.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#7c3aed">
  <meta name="msapplication-TileColor" content="#7c3aed">

  <style>
    :root{--accent:#7c3aed;--bg1:#071022;--bg2:#08142a;--card:rgba(255,255,255,0.03);--muted:#9fb0c7}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#eaf4ff}
    .wrap{max-width:1100px;margin:28px auto;padding:18px}
    header{display:flex;align-items:center;gap:12px}
    .logo img{width:64px;height:64px;object-fit:contain;border-radius:10px}
    h1{margin:0;font-size:20px}
    .lead{color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:18px}
    .card{background:var(--card);padding:18px;border-radius:14px;box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    .muted{color:var(--muted);font-size:13px}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:var(--accent);color:white;text-decoration:none;font-weight:700;border:none;cursor:pointer}
    .mutebtn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px;border-radius:10px}
    label{display:block;margin-top:12px;font-weight:700}
    input[type=file]{display:block;margin-top:8px}
    #preview,#resultImg{max-width:100%;border-radius:10px;display:block;margin-top:12px}
    .watermark{position:absolute;left:12px;bottom:12px;padding:6px 10px;background:rgba(0,0,0,0.35);border-radius:8px;font-weight:700}
    footer{margin-top:20px;color:var(--muted);font-size:13px;text-align:center}
    @media (max-width:900px){.grid{grid-template-columns:1fr}.logo img{width:56px;height:56px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"><img src="logo.png" alt="AI Beauty Fix logo" id="siteLogo" onerror="this.style.display='none'"></div>
      <div>
        <h1>üî• AI Beauty Fix</h1>
        <div class="lead">Gyors AI fot√≥-retus√°l√°s ‚Äî pr√≥b√°ld ki ingyen, 3 k√©p/nap (v√≠zjellel). PayPal: <code>atika.76@windowslive.com</code></div>
      </div>
      <nav style="margin-left:auto">
        <a href="#upload" onclick="showView('upload')" class="muted">Felt√∂lt√©s</a>
        <a href="#pricing" onclick="showView('pricing')" class="muted" style="margin-left:12px">√Årak</a>
        <a href="#admin" onclick="showView('admin')" class="muted" style="margin-left:12px">Admin</a>
      </nav>
    </header>

    <main class="grid">
      <!-- MAIN ACTION -->
      <section class="card" id="uploadSection">
        <h2>Felt√∂lt√©s & Retus√°l√°s</h2>
        <p class="muted">Max 20 MB / k√©p. Ingyenes fi√≥k: <strong>3 ingyenes retus / nap</strong> (v√≠zjellel).</p>

        <div style="margin-top:12px">
          <label for="fileInput">V√°lassz k√©pet (JPG/PNG)</label>
          <input id="fileInput" type="file" accept="image/*">
          <canvas id="canvas" style="display:none"></canvas>
          <img id="preview" src="#" alt="preview" style="display:none">
        </div>

        <div style="margin-top:12px">
          <label>Opci√≥</label>
          <select id="optionSelect">
            <option value="free">Ingyenes retus (v√≠zjel) ‚Äî limit 3/nap</option>
            <option value="credit">Haszn√°lj kreditet (v√≠zjel n√©lk√ºli)</option>
            <option value="paynow">V√°s√°rl√°s / egyedi fizet√©s</option>
          </select>
        </div>

        <div style="margin-top:12px">
          <button class="btn" id="processBtn">Retus√°l√°s ind√≠t√°sa</button>
          <button class="mutebtn" onclick="showView('pricing')" style="margin-left:8px">Kredit v√°s√°rl√°s / El≈ëfizet√©s</button>
          <span id="status" class="muted" style="margin-left:10px"></span>
        </div>

        <div id="resultWrap" style="margin-top:16px;display:none;position:relative">
          <h3>Eredm√©ny</h3>
          <img id="resultImg" src="#" alt="result">
          <div id="wmTag" class="watermark" style="display:none">AI Beauty Fix ‚Äî DEMO (V√çZJEL)</div>
          <div style="margin-top:10px">
            <a id="downloadBtn" class="btn" download>Let√∂lt√©s</a>
          </div>
        </div>
      </section>

      <!-- PRICING -->
      <aside class="card" id="pricingSection">
        <h3>√Årak & Csomagok</h3>
        <p class="muted">1 retus = 1 kredit. V√°laszd a neked megfelel≈ët ‚Äî a PayPal gombok a fizet√©shez visznek.</p>

        <!-- Kredit csomagok -->
        <div id="pricingForms" style="margin-top:12px">
          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
            <input type="hidden" name="cmd" value="_xclick">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="10 retus kredit">
            <input type="hidden" name="amount" value="1490">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="hidden" name="cancel_return" value="">
            <input type="submit" class="btn" value="10 retus ‚Äî 1490 Ft">
          </form>

          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
            <input type="hidden" name="cmd" value="_xclick">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="20 retus kredit">
            <input type="hidden" name="amount" value="2490">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="hidden" name="cancel_return" value="">
            <input type="submit" class="btn" value="20 retus ‚Äî 2490 Ft">
          </form>

          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
            <input type="hidden" name="cmd" value="_xclick">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="50 retus kredit">
            <input type="hidden" name="amount" value="4990">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="hidden" name="cancel_return" value="">
            <input type="submit" class="btn" value="50 retus ‚Äî 4990 Ft">
          </form>

          <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post">
            <input type="hidden" name="cmd" value="_xclick">
            <input type="hidden" name="business" value="atika.76@windowslive.com">
            <input type="hidden" name="item_name" value="100 retus kredit">
            <input type="hidden" name="amount" value="7990">
            <input type="hidden" name="currency_code" value="HUF">
            <input type="hidden" name="return" value="">
            <input type="hidden" name="cancel_return" value="">
            <input type="submit" class="btn" value="100 retus ‚Äî 7990 Ft">
          </form>
        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.04)">

        <h4>Havi el≈ëfizet√©sek</h4>
        <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin-bottom:8px">
          <input type="hidden" name="cmd" value="_xclick-subscriptions">
          <input type="hidden" name="business" value="atika.76@windowslive.com">
          <input type="hidden" name="item_name" value="AI Beauty Fix - Alap (50 retus/h√≥)">
          <input type="hidden" name="a3" value="2490">
          <input type="hidden" name="p3" value="1">
          <input type="hidden" name="t3" value="M">
          <input type="hidden" name="currency_code" value="HUF">
          <input type="hidden" name="return" value="">
          <input type="submit" class="btn" value="Alap ‚Äî 2490 Ft / h√≥">
        </form>

        <form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post">
          <input type="hidden" name="cmd" value="_xclick-subscriptions">
          <input type="hidden" name="business" value="atika.76@windowslive.com">
          <input type="hidden" name="item_name" value="AI Beauty Fix - Premium (150 retus/h√≥)">
          <input type="hidden" name="a3" value="4990">
          <input type="hidden" name="p3" value="1">
          <input type="hidden" name="t3" value="M">
          <input type="hidden" name="currency_code" value="HUF">
          <input type="hidden" name="return" value="">
          <input type="submit" class="btn" value="Pr√©mium ‚Äî 4990 Ft / h√≥">
        </form>

        <hr style="margin-top:12px;border:none;border-top:1px solid rgba(255,255,255,0.04)">
        <p class="muted">√âles haszn√°lathoz sz√ºks√©ges: PayPal IPN/Webhook hiteles√≠t√©s szerver-oldalon.</p>
      </aside>
    </main>

    <!-- Admin panel (rejtett) -->
    <div id="admin" class="card" style="margin-top:18px;display:none">
      <h3>Admin panel</h3>
      <p class="muted">Demo admin: az al√°bbi gombbal be√°ll√≠that√≥ admin m√≥d a saj√°t b√∂ng√©sz≈ëd√∂n (kliens-oldali).</p>
      <div style="margin-top:10px">
        <button class="btn" onclick="setAdminMode()">Admin bel√©p√©s</button>
        <button class="mutebtn" onclick="clearAdminMode()">Admin kikapcsol√°s</button>
      </div>
    </div>

    <footer>
      <p class="muted">¬© AI Beauty Fix ‚Ä¢ PayPal: atika.76@windowslive.com</p>
    </footer>
  </div>

  <!-- ======= SCRIPTS ======= -->
  <script>
    // Simple router
    function showView(id){
      document.getElementById('uploadSection').style.display = (id==='upload' || id==='') ? 'block' : 'none';
      document.getElementById('pricingSection').style.display = (id==='pricing') ? 'block' : 'none';
      document.getElementById('admin').style.display = (id==='admin') ? 'block' : 'none';
      // note: sections are same DOM as cards; show/hide handled above
      window.location.hash = '#'+id;
    }
    // init
    showView('upload');

    // Credits (localStorage)
    function getCredits(){return Number(localStorage.getItem('aib_credits')||0)}
    function setCredits(n){localStorage.setItem('aib_credits',String(n)); document.querySelectorAll('#creditDisplay').forEach(e=>e.innerText=n)}
    setCredits(getCredits());

    // Free usage tracking (3 free per day)
    function freeCountToday(){ const k='aib_free_'+(new Date()).toISOString().slice(0,10); return Number(localStorage.getItem(k)||0) }
    function incFreeCount(){ const k='aib_free_'+(new Date()).toISOString().slice(0,10); localStorage.setItem(k,String(freeCountToday()+1)) }

    // File handling & preview
    const fileInput = document.getElementById('fileInput');
    const preview = document.getElementById('preview');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext ? canvas.getContext('2d') : null;
    let currentImage = null;
    fileInput.addEventListener('change', e=>{
      const f = e.target.files[0];
      if(!f) return;
      if(f.size > 20*1024*1024){ alert('A f√°jl t√∫l nagy (max 20MB)'); return; }
      const url = URL.createObjectURL(f);
      preview.src = url; preview.style.display = 'block'; currentImage = f;
    });

    document.getElementById('processBtn').addEventListener('click', ()=>{
      if(!currentImage){ alert('V√°lassz egy k√©pet!'); return; }
      const opt = document.getElementById('optionSelect').value;
      if(opt === 'free'){
        if(freeCountToday() >= 3){ alert('El√©rted a napi ingyenes limitet (3). V√°s√°rolj kreditet vagy el≈ëfizet√©st.'); return; }
        incFreeCount(); simulateRetouch(true);
      } else if(opt === 'credit'){
        if(getCredits() <= 0){ if(confirm('Nincsen el√©g kredited. V√°s√°rolsz most?')) showView('pricing'); return; }
        setCredits(getCredits()-1); simulateRetouch(false);
      } else {
        showView('pricing'); alert('V√°lassz egy kreditcsomagot a fizet√©shez.');
      }
    });

    // Simulated retouch (client-side demo): replace with server-side AI call later.
    function simulateRetouch(watermarked){
      if(!ctx){ alert('A b√∂ng√©sz≈ëd nem t√°mogatja a sz√ºks√©ges canvas API-t.'); return; }
      const img = new Image();
      img.onload = ()=>{
        canvas.width = img.width; canvas.height = img.height; ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.drawImage(img,0,0);
        try{ ctx.filter='contrast(1.06) saturate(1.05)'; ctx.drawImage(canvas,0,0); }catch(e){}
        const tmp = document.createElement('canvas'); tmp.width = Math.max(1,Math.floor(img.width*0.5)); tmp.height = Math.max(1,Math.floor(img.height*0.5));
        const tctx = tmp.getContext('2d'); tctx.drawImage(canvas,0,0,tmp.width,tmp.height); ctx.drawImage(tmp,0,0,img.width,img.height);
        ctx.globalCompositeOperation='soft-light'; ctx.fillStyle='rgba(255,240,220,0.02)'; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.globalCompositeOperation='source-over';
        const dataUrl = canvas.toDataURL('image/jpeg',0.92);
        document.getElementById('resultImg').src = dataUrl;
        document.getElementById('resultWrap').style.display = 'block';
        document.getElementById('downloadBtn').href = dataUrl;
        if(watermarked){ document.getElementById('wmTag').style.display = 'block'; applyWatermarkToCanvas(); } else { document.getElementById('wmTag').style.display = 'none'; }
      };
      img.src = URL.createObjectURL(currentImage);
    }

    function applyWatermarkToCanvas(){
      if(!ctx) return;
      const txt = 'AI Beauty Fix';
      ctx.font = '36px system-ui';
      ctx.fillStyle = 'rgba(255,255,255,0.12)';
      ctx.textAlign = 'left';
      ctx.fillText(txt, 20, canvas.height - 40);
      const data = canvas.toDataURL('image/jpeg',0.92);
      document.getElementById('resultImg').src = data;
      document.getElementById('downloadBtn').href = data;
    }

    // PayPal demo return handling: adds credits after redirect (demo only)
    (function handleReturn(){
      const qp = new URLSearchParams(location.search);
      if(qp.get('paid') === '1'){
        const pack = qp.get('pack'); let add = 0;
        if(pack === '10') add = 10; if(pack === '20') add = 20; if(pack === '50') add = 50; if(pack === '100') add = 100;
        if(add > 0){ setCredits(getCredits() + add); alert('K√∂sz√∂nj√ºk! A kifizet√©s feldolgozva (demo). '+add+' kreditet j√≥v√°√≠rtunk.'); }
      }
      if(qp.get('sub')){ const s = qp.get('sub'); if(s==='basic'){ setCredits(50); alert('El≈ëfizet√©s aktiv√°lva (demo): 50 kredit/h√≥'); } if(s==='premium'){ setCredits(150); alert('El≈ëfizet√©s aktiv√°lva (demo): 150 kredit/h√≥'); } if(s==='pro'){ setCredits(9999); alert('Pro el≈ëfizet√©s: korl√°tlan (demo)'); } }
    })();

    // Auto-set PayPal return URLs so forms work on GitHub Pages without manual edit
    document.addEventListener('DOMContentLoaded', function(){
      const origin = window.location.origin;
      const path = window.location.pathname.replace(/\/index\.html$/, '/');
      const base = origin + path;
      const forms = document.querySelectorAll('form[action*="paypal.com"]');
      forms.forEach(form=>{
        const item = form.querySelector('input[name=item_name]');
        let pack = '';
        if(item){
          const name = item.value.toLowerCase();
          if(name.includes('10')) pack='?paid=1&pack=10';
          if(name.includes('20')) pack='?paid=1&pack=20';
          if(name.includes('50')) pack='?paid=1&pack=50';
          if(name.includes('100')) pack='?paid=1&pack=100';
          if(name.includes('alap')) pack='?sub=basic';
          if(name.includes('premium')) pack='?sub=premium';
          if(name.includes('pro')) pack='?sub=pro';
        }
        const ret = form.querySelector('input[name=return]');
        const cancel = form.querySelector('input[name=cancel_return]');
        if(ret) ret.value = base + (pack || '');
        if(cancel) cancel.value = base + '?cancel=1';
      });

      // show credits UI values (if any element exists)
      const cd = document.querySelector('#creditDisplay');
      if(cd) cd.innerText = getCredits();
    });

    // ------------------ ADMIN BYPASS (CLIENT-SIDE DEMO) ------------------
    // Use setAdminMode() once in your browser to enable admin mode (never share the password).
    function setAdminMode(){
      const pw = prompt('Admin jelsz√≥:');
      // CHANGE this password here to your secret before uploading (example below)
      if(pw === 'sajatAdminJelszo2025'){ localStorage.setItem('aib_is_admin','1'); alert('Admin m√≥d aktiv√°lva ezen a b√∂ng√©sz≈ën.'); location.reload(); }
      else alert('Hib√°s jelsz√≥.');
    }
    function clearAdminMode(){ localStorage.removeItem('aib_is_admin'); alert('Admin m√≥d kikapcsolva.'); location.reload(); }
    function isAdmin(){ return localStorage.getItem('aib_is_admin') === '1'; }

    // If admin, grant huge credit and show admin badge
    document.addEventListener('DOMContentLoaded', ()=>{
      if(isAdmin()){
        try{ setCredits(999999); }catch(e){}
        const badge = document.createElement('div');
        badge.innerText = 'Admin m√≥d';
        badge.style.position='fixed';
        badge.style.right='12px';
        badge.style.bottom='12px';
        badge.style.background='linear-gradient(90deg,#7c3aed,#6d28d9)';
        badge.style.color='white';
        badge.style.padding='8px 10px';
        badge.style.borderRadius='10px';
        badge.style.fontWeight='700';
        badge.style.zIndex='9999';
        badge.style.cursor='pointer';
        badge.title='Kattints a admin m√≥d kikapcsol√°s√°hoz';
        badge.onclick = ()=>{ if(confirm('Kikapcsolod az admin m√≥dot?')) clearAdminMode(); };
        document.body.appendChild(badge);
      }
    });
    // --------------------------------------------------------------------

  </script>
</body>
</html>
